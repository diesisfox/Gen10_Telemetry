<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <text>Choose a Serial Port: </text>
    <select id="SerialPortSelect"></select><br>

    <text>Select Baud Rate: </text>
    <select id="BaudRateSelect">
    <option value="1200">1200</option>
    <option value="2400">2400</option>
    <option value="4800">4800</option>
    <option value="9600">9600</option>
    <option value="19200">19200</option>
    <option value="38400">38400</option>
    <option value="57600">57600</option>
    <option value="115200">115200</option>
</select><br>
    <input type="submit" value="Connect" id="ConnectSerial" onsubmit="ConnectSerial">

    <ul></ul>

    <script>
        'use strict';

        //Node Modules
        const electron = require('electron');
        const { ipcRenderer } = electron;
        const serial = require('serialport');

        //Custom Modules

        let port;

        //Loading Serial Port Selection Menu
        ipcRenderer.on('RefreshConnection', (event) => {
            serial.list((err, ports) => {
                document.getElementById('SerialPortSelect').innerHTML = '';
                if(ports.length > 0) {
                    ports.forEach((element) => {
                        const option = document.createElement('option');
                        const text = document.createTextNode(element.comName.toString());
                        option.appendChild(text);
                        document.getElementById('SerialPortSelect').appendChild(option);
                    });
                }
            });
        });

        function ConnectSerial(){
            const comName = document.getElementById('SerialPortSelect').getValue();
            const baudRate = document.getElementById('BaudRateSelect').getValue();
            port = new SerialPort(comName, {
                baudRate: baudRate
            });
        }

    </script>
</body>
</html>